{
	"code": 200,
	"error": "",
	"message": "",
	"data": {
		"id": "f5e0373406f5421fa83b800aa5a6381f",
		"createBy": "10043",
		"createDate": "2022-09-16 17:16:31",
		"updateBy": "10043",
		"updateDate": "2022-09-16 17:16:31",
		"remarks": null,
		"orders": null,
		"isNewRecord": false,
		"parentId": "41da1f294902473d95349b921a1cff5a",
		"parentIds": "0,5194d081fc3b49c18a5be99f0fe79d81,fe65133efb01411c9a5990d5d92c9e1b,41da1f294902473d95349b921a1cff5a",
		"name": "CPU架构和系统发行版验收",
		"type": "accept",
		"treeType": "1",
		"treeSort": 10,
		"treeLevel": 3,
		"description": "CPU架构和系统发行版验收",
		"script": {
			"id": "bd48ad038b4a42d4b709cf9d53a921b7",
			"createBy": "1",
			"createDate": "2021-10-25 13:08:53",
			"updateBy": "1",
			"updateDate": "2021-11-23 10:21:16",
			"remarks": null,
			"orders": null,
			"isNewRecord": false,
			"name": "检查CPU架构和系统发行版",
			"type": "action_script",
			"version": "1.0.1",
			"lang": "python",
			"code": "# version: Python3\n###################################################################################################\n#调试打印变量：\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n#    var = \"test\"\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n#\t raise Exception(var)\n#result字典说明：\n#\t result[\"rc\"]: 0或1，0表示指令执行成功，1表示指令执行失败\n#\t result[\"failed\"]: 脚本执行状态(对应用status)，True或False,设置该值可以定义脚本成功或失败\n# \t result[\"stdout\"]: 指令执行成功时的输出数据(对应用originalMsg)\n#    result[\"stderr\"]：指令执行出错时的描述信息\n#    result[\"msg\"]：用户自定义的错误描述信息(脚本失败时对应detail)，如巡检CPU指标异常\n###################################################################################################\n# please edit your code here:\ndef process(self, task_vars):\n    self._task.args['_raw_params'] = 'uname -a'\n    result = self.execute_cmd(task_vars)\n    if 'stdout' in result and check_0(result['stdout']):\n        self._task.args['_raw_params'] = 'cat /etc/redhat-release'\n        result_2 = self.execute_cmd(task_vars)\n        if 'stdout' in result_2 and check_2(result['stdout']):\n            result['original_message'] = result.get('stdout', '') + '\\n' + result_2.get('stdout', '')\n    if 'original_message' not in result:\n        result['original_message'] = 'failed'\n        result['failed'] = True\n    return result\n\ndef check_0(stdout):\n    if 'arch'  in stdout:\n        return True\n    else:\n        return False\n    \ndef check_2(stdout):\n    if '7.8' in stdout or 'CentOS'  in stdout:\n        return True\n    else:\n        return False\n    \n\ndef main(self, task_vars):\n    result = {\n    \t\"rc\": 0\n    }\n    process(self, task_vars)\n    return result",
			"base64Code": "IyB2ZXJzaW9uOiBQeXRob24zCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoj6LCD6K+V5omT5Y2w5Y+Y6YeP77yaCQkJCQkJCQkJCQkJCQkJCQkJCQojICAgIHZhciA9ICJ0ZXN0IgkJCQkJCQkJCQkJCQkJCQkJCQkKIwkgcmFpc2UgRXhjZXB0aW9uKHZhcikKI3Jlc3VsdOWtl+WFuOivtOaYju+8mgojCSByZXN1bHRbInJjIl06IDDmiJYx77yMMOihqOekuuaMh+S7pOaJp+ihjOaIkOWKn++8jDHooajnpLrmjIfku6TmiafooYzlpLHotKUKIwkgcmVzdWx0WyJmYWlsZWQiXTog6ISa5pys5omn6KGM54q25oCBKOWvueW6lOeUqHN0YXR1cynvvIxUcnVl5oiWRmFsc2Us6K6+572u6K+l5YC85Y+v5Lul5a6a5LmJ6ISa5pys5oiQ5Yqf5oiW5aSx6LSlCiMgCSByZXN1bHRbInN0ZG91dCJdOiDmjIfku6TmiafooYzmiJDlip/ml7bnmoTovpPlh7rmlbDmja4o5a+55bqU55Sob3JpZ2luYWxNc2cpCiMgICAgcmVzdWx0WyJzdGRlcnIiXe+8muaMh+S7pOaJp+ihjOWHuumUmeaXtueahOaPj+i/sOS/oeaBrwojICAgIHJlc3VsdFsibXNnIl3vvJrnlKjmiLfoh6rlrprkuYnnmoTplJnor6/mj4/ov7Dkv6Hmga8o6ISa5pys5aSx6LSl5pe25a+55bqUZGV0YWlsKe+8jOWmguW3oeajgENQVeaMh+agh+W8guW4uAojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBwbGVhc2UgZWRpdCB5b3VyIGNvZGUgaGVyZToKZGVmIHByb2Nlc3Moc2VsZiwgdGFza192YXJzKToKICAgIHNlbGYuX3Rhc2suYXJnc1snX3Jhd19wYXJhbXMnXSA9ICd1bmFtZSAtYScKICAgIHJlc3VsdCA9IHNlbGYuZXhlY3V0ZV9jbWQodGFza192YXJzKQogICAgaWYgJ3N0ZG91dCcgaW4gcmVzdWx0IGFuZCBjaGVja18wKHJlc3VsdFsnc3Rkb3V0J10pOgogICAgICAgIHNlbGYuX3Rhc2suYXJnc1snX3Jhd19wYXJhbXMnXSA9ICdjYXQgL2V0Yy9yZWRoYXQtcmVsZWFzZScKICAgICAgICByZXN1bHRfMiA9IHNlbGYuZXhlY3V0ZV9jbWQodGFza192YXJzKQogICAgICAgIGlmICdzdGRvdXQnIGluIHJlc3VsdF8yIGFuZCBjaGVja18yKHJlc3VsdFsnc3Rkb3V0J10pOgogICAgICAgICAgICByZXN1bHRbJ29yaWdpbmFsX21lc3NhZ2UnXSA9IHJlc3VsdC5nZXQoJ3N0ZG91dCcsICcnKSArICdcbicgKyByZXN1bHRfMi5nZXQoJ3N0ZG91dCcsICcnKQogICAgaWYgJ29yaWdpbmFsX21lc3NhZ2UnIG5vdCBpbiByZXN1bHQ6CiAgICAgICAgcmVzdWx0WydvcmlnaW5hbF9tZXNzYWdlJ10gPSAnZmFpbGVkJwogICAgICAgIHJlc3VsdFsnZmFpbGVkJ10gPSBUcnVlCiAgICByZXR1cm4gcmVzdWx0CgpkZWYgY2hlY2tfMChzdGRvdXQpOgogICAgaWYgJ2FyY2gnICBpbiBzdGRvdXQ6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAKZGVmIGNoZWNrXzIoc3Rkb3V0KToKICAgIGlmICc3LjgnIGluIHN0ZG91dCBvciAnQ2VudE9TJyAgaW4gc3Rkb3V0OgogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAgIHJldHVybiBGYWxzZQogICAgCgpkZWYgbWFpbihzZWxmLCB0YXNrX3ZhcnMpOgogICAgcmVzdWx0ID0gewogICAgCSJyYyI6IDAKICAgIH0KICAgIHByb2Nlc3Moc2VsZiwgdGFza192YXJzKQogICAgcmV0dXJuIHJlc3VsdA==",
			"label": null,
			"authScope": null,
			"args": null,
			"params": [],
			"description": "",
			"beginDate": null,
			"endDate": null,
			"user": null,
			"authUser": null,
			"editable": null
		},
		"timeout": null,
		"delegateToLocal": "0",
		"targetDevice": null,
		"bmcExecute": "0",
		"authScope": null
	}
}
